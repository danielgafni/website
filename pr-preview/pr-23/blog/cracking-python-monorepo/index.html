<!doctype html><html data-theme=dark lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://danielgafni.github.io/website/pr-preview/pr-23 name=base><title>~/danielgafni • Cracking the Python monorepo</title><link href=https://danielgafni.github.io/website/pr-preview/pr-23/favicon.png rel=icon type=image/png><link href=https://danielgafni.github.io/website/pr-preview/pr-23/atom.xml rel=alternate title=~/danielgafni type=application/atom+xml><link href="https://danielgafni.github.io/website/pr-preview/pr-23/inter_subset_en.css?h=d8cf4ad058d6c3a4015b" rel=stylesheet><link href="https://danielgafni.github.io/website/pr-preview/pr-23/main.css?h=adbdec823fffb79bc7c3" rel=stylesheet><link href="https://danielgafni.github.io/website/pr-preview/pr-23/skins/catppuccin.css?h=ddda112c1cfca66427b5" rel=stylesheet><meta content="light dark" name=color-scheme><meta media="(prefers-color-scheme: light)" content=#7287fd name=theme-color><meta media="(prefers-color-scheme: dark)" content=#81c8be name=theme-color><meta name=description><meta property=og:description><meta content="index, nofollow" name=robots><meta content="Cracking the Python monorepo" property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><meta content=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/ property=og:url><meta content=~/danielgafni property=og:site_name><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com giscus.app;connect-src 'self';script-src 'self'  giscus.app 'self'" http-equiv=Content-Security-Policy><noscript><link href=https://danielgafni.github.io/website/pr-preview/pr-23/no_js.css rel=stylesheet></noscript><script src=https://danielgafni.github.io/website/pr-preview/pr-23/js/initializeTheme.min.js></script><script defer src=https://danielgafni.github.io/website/pr-preview/pr-23/js/themeSwitcher.min.js></script><script src="https://danielgafni.github.io/website/pr-preview/pr-23/search_index.en.js?h=61a22ad96c250069f56e" defer></script><script src="https://danielgafni.github.io/website/pr-preview/pr-23/js/searchElasticlunr.min.js?h=2950d57f80c9fa78f37e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://danielgafni.github.io/website/pr-preview/pr-23>~/danielgafni</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/> /blog </a><li><a class="nav-links no-hover-padding" href=https://danielgafni.github.io/website/pr-preview/pr-23/archive/> /archive </a><li><a class="nav-links no-hover-padding" href=https://danielgafni.github.io/website/pr-preview/pr-23/tags/> /tags </a><li><a class="nav-links no-hover-padding" href=https://danielgafni.github.io/website/pr-preview/pr-23/projects/> /projects </a><li><a class="nav-links no-hover-padding" href=https://danielgafni.github.io/website/pr-preview/pr-23/about/> /about </a><li class=js><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" title="Reset mode to default" aria-hidden=true class=theme-resetter role=button tabindex=0></div></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Cracking the Python monorepo</h1><ul class=meta><li class=draft-label>DRAFT<li>20th Feb 2025</li> • <li title="1363 words">7 min read</li> • <li>Tags: <li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/tags/python/>Python</a>, <li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/tags/dagger/>Dagger</a>, <li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/tags/monorepo/>Monorepo</a></ul><div class=toc-container><h3>Table of Contents</h3><ul><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#python-monorepo-sounds-like-a-nightmare>Python monorepo? Sounds like a nightmare!</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#hide-your-kids-python-packaging-incoming>Hide your kids: Python packaging incoming!</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#hey-enough-talking-how-about-we-write-some-code>Hey, enough talking, how about we write some code?</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#cache-me-if-you-can>Cache me if you can</a></ul></div><section class=body><p>A monorepo is a single repository that contains multiple projects. It is a popular way to organize codebases in large companies like Google, Meta and Twitter.<p>For a long time I did not understand the benefits of monorepos. I thought they were used because people could not figure out how to split their codebases into smaller parts.<p>After working at <a href=https://dagster.io>Dagster</a> (Dagster has a pretty huge monorepo with more than 140k lines of code and 70+ subprojects), I realized that monorepos can provide a quite pleasant development experience when done right - with the right tooling, practices, and of course, the right use case.<p>It’s worth noting that monorepos are not a silver bullet. They have their own set of challenges, mostly the need to build custom tooling. The big tech companies have the resources to build and maintain these tools, but for smaller and medium-sized companies, it can be quite challenging. Dagster’s monorepo wasn’t perfect. Some of the drawbacks were:<ul><li>slow CI/CD pipelines<li>legacy Python build system (I started migrating it to <code>uv</code> but at the time it was <a href=https://github.com/dagster-io/dagster/pull/23814#issuecomment-2364694200>blocked</a> by the fact that we had test suites with conflicting dependencies) made maintaining dependencies and CI pipelines quite complicated</ul><p>That’s why this post focuses on a very specific use case - Python monorepos. Until very recently, Python monorepos were quite hard to set up and maintain. However, nowadays we have a bunch of excellent tools with built-in monorepo support.<p>In this post I am going to share an approach to Python monorepos that solves these issues in a very elegant way. We will walk through a typical monorepo setup and use <a href=https://astral.sh/uv>uv</a> and <a href=https://dagger.io>Dagger</a> to build lightning-fast and modular monorepo pipelines.<h1 id=python-monorepo-sounds-like-a-nightmare><a aria-label="Anchor link for: python-monorepo-sounds-like-a-nightmare" class="header-anchor no-hover-padding" href=#python-monorepo-sounds-like-a-nightmare><span aria-hidden=true class=link-icon></span></a> Python monorepo? Sounds like a nightmare!</h1><p>It’s really not with the right tooling! Enter:<ul><li><code>uv</code> has the concept of <a href=https://astral.sh/uv/docs/workspaces>workspaces</a> which allows installing individual packages from a monorepo and makes managing dependencies a breeze.<li><code>ruff</code> has first-class support for monorepos and is able to automatically discover and merve configuration files from multiple subprojects. Ruff will be the linting and formatting tool of choice for our monorepo.<li>same goes for <code>pyright</code> - the type checker we are going to use.<li>at last, we have <code>Dagger</code> - a universal build tool which supports multiple languages (including Python) to define containerized build pipelines. Because Dagger pipelines are written in Python, we can easily adapt them to our monorepo and create reusable, composable, and testable build pipelines.</ul><h1 id=hide-your-kids-python-packaging-incoming><a aria-label="Anchor link for: hide-your-kids-python-packaging-incoming" class="header-anchor no-hover-padding" href=#hide-your-kids-python-packaging-incoming><span aria-hidden=true class=link-icon></span></a> Hide your kids: Python packaging incoming!</h1><p>In contrary to what you might think, Python packaging is not a nightmare anymore. It used to be, but with the introduction of <a href=https://peps.python.org/pep-0517/>PEP 517</a> and <a href=https://peps.python.org/pep-0518/>PEP 518</a>, and the rise of <code>uv</code>, it’s actually in a pretty good shape - I rarely have to pull out my hair when working with Python packaging nowadays.<p>The PEPs and their adoption was important to standardize the way Python packages are built and distributed. Since the overwhelming majority of Python packages now provide correct distribution metadata (like hashes of the package contents), it’s much easier for advanced and optimized package managers like <code>uv</code> to do their job really well. Some machine learning dependencies - and <a href=https://github.com/pytorch/pytorch/issues/76557>specifically pytorch</a> - used to sabotage the Python packaging ecosystem, but even PyTorch now (mostly) provides the hashes with the various wheels they build for all these CUDA versions.<p>Therefore, I’d like to note that the improvements with packaging are not only due to better tooling like <code>uv</code>, but also due to the community’s effort to standardize and improve the Python packaging ecosystem.<h1 id=hey-enough-talking-how-about-we-write-some-code><a aria-label="Anchor link for: hey-enough-talking-how-about-we-write-some-code" class="header-anchor no-hover-padding" href=#hey-enough-talking-how-about-we-write-some-code><span aria-hidden=true class=link-icon></span></a> Hey, enough talking, how about we write some code?</h1><p>Fair enough! Let’s start by invoking <code>uv</code> (assuming the dear reader has - and he should - <code>uv</code> installed) and creating a new workspace:<pre class="language-shell z-code" data-lang=shell><code class=language-shell data-lang=shell><span class="z-text z-plain">mkdir uv-dagger-dream
</span><span class="z-text z-plain">cd uv-dagger-dream
</span><span class="z-text z-plain">uv init
</span><span class="z-text z-plain">uv add --group dev ruff pyright
</span><span class="z-text z-plain">mkdir projects
</span><span class="z-text z-plain">uv init --package --lib projects/lib-one
</span><span class="z-text z-plain">uv init --package --lib projects/lib-two
</span></code></pre><p>Phew! That was a lot of commands. Let’s break them down:<ul><li><code>uv init</code> initializes a project. A workspace is a directory that contains one or more packages. It’s a way to group packages together and manage their dependencies, while allowing cross-package dependencies.<li><code>uv add --group dev</code> adds dependencies to the root project. Development groups are only used when working on the project and are not registered as dependencies when the project is published. Downstream projects will not inherit these dependencies.<li><code>uv init --package --lib projects/lib-one</code> initializes a new package in the <code>projects</code> directory. The <code>--lib</code> flag tells <code>uv</code> that this package is a library. This is important because it will add a <code>[build-system]</code> section to the <code>pyproject.toml</code> file, which is required for <code>uv</code> to know how to build the package.</ul><p>After this section, you should see something like this (non-essential files are omitted):<pre class=z-code><code><span class="z-text z-plain">.
</span><span class="z-text z-plain">├── README.md
</span><span class="z-text z-plain">├── projects
</span><span class="z-text z-plain">│   ├── lib-one
</span><span class="z-text z-plain">│   │   ├── pyproject.toml
</span><span class="z-text z-plain">│   │   └── src
</span><span class="z-text z-plain">│   │       └── lib_one
</span><span class="z-text z-plain">│   │           └── __init__.py
</span><span class="z-text z-plain">│   └── lib-two
</span><span class="z-text z-plain">│       ├── pyproject.toml
</span><span class="z-text z-plain">│       └── src
</span><span class="z-text z-plain">│           └── lib_two
</span><span class="z-text z-plain">│               └── __init__.py
</span><span class="z-text z-plain">├── pyproject.toml
</span><span class="z-text z-plain">└── uv.lock
</span></code></pre><p>🎉 We have a monorepo! Projects recognized as <code>uv</code> workspace members share the same <code>uv.lock</code> file, environment, can be added as dependencies to each other, and can be managed with <code>uv</code> commands.<p>{{ admonition(type=“tip”, text=“I like to edit the root <code>pyproject.toml</code> and replace <code>workspace.members = ["projects/lib-one", "projects/lib-two"]</code> with <code>workspace.members = ["projects/*"]</code> so that all the packages in the <code>projects</code> directory are recognized as workspace members.”) }} with<p>To demonstrate how one project can be added as a dependency to another, let’s add <code>lib-one</code> as a dependency to <code>lib-two</code>:<pre class="language-shell z-code" data-lang=shell><code class=language-shell data-lang=shell><span class="z-text z-plain">uv add --package lib-two lib-one
</span></code></pre><p>The <code>--package</code> flag tells <code>uv</code> to execute the command in the context of the <code>lib-two</code> package. The <code>lib-one</code> package is added as a dependency to <code>lib-two</code>’s <code>pyproject.toml</code> and the root <code>uv.lock</code> file is updated automatically.<h1 id=cache-me-if-you-can><a aria-label="Anchor link for: cache-me-if-you-can" class="header-anchor no-hover-padding" href=#cache-me-if-you-can><span aria-hidden=true class=link-icon></span></a> Cache me if you can</h1><p>Who knows how to write a <code>Doockerfile</code>? I’m sure you do. Do you know how to write it efficiently? Are you sure? In any case, we are about to unleash the combined power of <code>Dagger</code>, <code>BuildKit</code>, and <code>uv</code>, to build our monorepo in a very (<strong>very</strong>) efficient way.<p>First, we don’t actually need a <code>Dockerfile</code>. We could use <code>Dagger</code> to define the entire build process in Python. But since it could somewhat complicate building the project with other tools, we are still going to write a <code>Dockerfile</code>, but:<ol><li>We will define an intermediate stage <em>almost</em> identical to the final stage.<li>We will then call <code>Dagger</code> to build the project in the intermediate stage. We will then complete the final build stage with <code>Dagger</code> in a very efficient way.</ol><p>For simplicity, all the subprojects will share the same <code>Dockerfile</code>. Here it is!<pre class="language-dockerfile z-code" data-lang=dockerfile><code class=language-dockerfile data-lang=dockerfile><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> options: prod,dev
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ARG </span>INCLUDE_DEPENDENCIES=dev
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ARG </span>PYTHON_VERSION=3.11.7
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">FROM</span> python:<span class="z-entity z-name z-enum z-tag-digest">${PYTHON_VERSION}-slim</span> <span class="z-keyword z-control z-dockerfile">AS</span> <span class="z-variable z-stage-name">base</span>
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ENV </span>DEBIAN_FRONTEND=noninteractive
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> some apt packages usually needed in Python projects
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>--mount=type=cache,target=/var/cache/apt,sharing=locked \
</span><span class="z-source z-dockerfile">    apt-get update && apt-get install -y git curl gcc libpq-dev
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> install uv (https://github.com/astral-sh/uv)
</span></span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> docs for using uv with Docker: https://docs.astral.sh/uv/guides/integration/docker/
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">COPY</span> --from=<span class="z-variable z-stage-name">ghcr.io/astral-sh/uv:0.5.27</span> /uv /bin/uv
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> UV_PROJECT_ENVIRONMENT configures the environment for the uv project interface
</span></span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> UV_PYTHON configures the python executable for the uv pip interface
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ENV </span>UV_PROJECT_ENVIRONMENT=/usr/local/ \
</span><span class="z-source z-dockerfile">    UV_PYTHON=/usr/local/bin/python \
</span><span class="z-source z-dockerfile">    UV_COMPILE_BYTECODE=1 \
</span><span class="z-source z-dockerfile">    UV_LINK_MODE=copy \
</span><span class="z-source z-dockerfile">    UV_FROZEN=1
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">FROM</span> base <span class="z-keyword z-control z-dockerfile">AS</span> <span class="z-variable z-stage-name">deps-prod</span>
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">WORKDIR </span>/src
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">COPY</span> pyproject.toml uv.lock  ./
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ARG </span>PACKAGE
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>--mount=type=cache,target=/root/.cache/uv \
</span><span class="z-source z-dockerfile">    uv sync --no-install-workspace --all-extras --no-dev --package $PACKAGE
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">FROM</span> deps-prod <span class="z-keyword z-control z-dockerfile">AS</span> <span class="z-variable z-stage-name">deps-dev</span>
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ARG </span>PACKAGE
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>--mount=type=cache,target=/root/.cache/uv \
</span><span class="z-source z-dockerfile">    uv sync --no-install-workspace --only-group dev --inexact && \
</span><span class="z-source z-dockerfile">    uv sync --no-install-workspace --all-extras --inexact --package $PACKAGE
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> -------------------------------------------------------------
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">FROM</span> deps-${INCLUDE_DEPENDENCIES} <span class="z-keyword z-control z-dockerfile">AS</span> <span class="z-variable z-stage-name">final</span>
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">ARG </span>PACKAGE
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">COPY</span> $PACKAGE_DIR/pyproject.toml $PACKAGE_DIR/README.md $PACKAGE_DIR/
</span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>mkdir -p $PACKAGE_DIR/src/$PACKAGE && touch $PACKAGE_DIR/src/$PACKAGE/__init__.py
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> finally install our code
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">RUN </span>uv sync --all-extras --inexact --package $PACKAGE
</span><span class="z-source z-dockerfile">
</span><span class="z-source z-dockerfile"><span class="z-comment z-dockerfile"><span class="z-punctuation z-definition z-comment z-dockerfile">#</span> Copy all the rest of the code
</span></span><span class="z-source z-dockerfile"><span class="z-keyword z-control z-dockerfile">COPY</span> $PACKAGE_DIR ./$PACKAGE_DIR
</span></code></pre></section><nav class="full-width article-navigation"><div></div><div><a aria-describedby=right_title aria-label=Prev href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cloud-computing-eks-part-2/>Prev <span class=arrow>→</span></a><p aria-hidden=true id=right_title>Cloud Computing with EKS: Dagster with ArgoCD</div></nav><div class=comments data-category=Announcements data-category-id=DIC_kwDOLfTdus4CePI8 data-dark-theme=noborder_dark data-input-position=top data-lang=en data-lazy-loading=true data-light-theme=noborder_light data-mapping=specific data-reactions-enabled=1 data-repo=danielgafni/website data-repo-id=R_kgDOLfTdug data-strict=1 data-term=cracking-python-monorepo id=comments><script async src=https://danielgafni.github.io/website/pr-preview/pr-23/js/giscus.min.js></script><noscript>You need JavaScript to view the comments.</noscript></div></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#python-monorepo-sounds-like-a-nightmare>Python monorepo? Sounds like a nightmare!</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#hide-your-kids-python-packaging-incoming>Hide your kids: Python packaging incoming!</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#hey-enough-talking-how-about-we-write-some-code>Hey, enough talking, how about we write some code?</a><li><a href=https://danielgafni.github.io/website/pr-preview/pr-23/blog/cracking-python-monorepo/#cache-me-if-you-can>Cache me if you can</a></ul></div></div></div><a title="Go to the comments section" class=no-hover-padding href=#comments id=comments-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule=evenodd fill-rule=evenodd /></svg> </a><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://danielgafni.github.io/website/pr-preview/pr-23/js/copyCodeToClipboard.min.js></script><script defer src=https://danielgafni.github.io/website/pr-preview/pr-23/js/addSrcToCodeBlock.min.js></script><script defer src=https://danielgafni.github.io/website/pr-preview/pr-23/js/footnoteBacklinks.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://danielgafni.github.io/website/pr-preview/pr-23/atom.xml> <img alt=feed src=https://danielgafni.github.io/website/pr-preview/pr-23/social_icons/rss.svg title=feed> </a><li class=js><a class="nav-links no-hover-padding social" data-encoded-email=ZGFuaWVsZ2FmbmkxNkBnbWFpbC5jb20K href=#><img alt=email src=https://danielgafni.github.io/website/pr-preview/pr-23/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/danielgafni> <img alt=github src=https://danielgafni.github.io/website/pr-preview/pr-23/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://gitlab.com/danielgafni> <img alt=gitlab src=https://danielgafni.github.io/website/pr-preview/pr-23/social_icons/gitlab.svg title=gitlab> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://www.linkedin.com/in/danielgafni/> <img alt=linkedin src=https://danielgafni.github.io/website/pr-preview/pr-23/social_icons/linkedin.svg title=linkedin> </a></ul></nav><nav class=nav-navs></nav><div class=credits><small> <p><p>UNLICENSED 2025 Daniel Gafni • The contents of this website are free to use</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> • <a href=https://github.com/danielgafni/website> Site source </a></small></div></section><script async src=https://danielgafni.github.io/website/pr-preview/pr-23/js/decodeMail.min.js></script><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>